{"version":3,"file":"collapse.js","sources":["../src/collapse.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v4.3.1): collapse.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport Data from './dom/data'\nimport EventHandler from './dom/eventHandler'\nimport Manipulator from './dom/manipulator'\nimport SelectorEngine from './dom/selectorEngine'\nimport Util from './util'\n\n/**\n * ------------------------------------------------------------------------\n * Constants\n * ------------------------------------------------------------------------\n */\n\nconst NAME                = 'collapse'\nconst VERSION             = '4.3.1'\nconst DATA_KEY            = 'bs.collapse'\nconst EVENT_KEY           = `.${DATA_KEY}`\nconst DATA_API_KEY        = '.data-api'\n\nconst Default = {\n  toggle : true,\n  parent : ''\n}\n\nconst DefaultType = {\n  toggle : 'boolean',\n  parent : '(string|element)'\n}\n\nconst Event = {\n  SHOW           : `show${EVENT_KEY}`,\n  SHOWN          : `shown${EVENT_KEY}`,\n  HIDE           : `hide${EVENT_KEY}`,\n  HIDDEN         : `hidden${EVENT_KEY}`,\n  CLICK_DATA_API : `click${EVENT_KEY}${DATA_API_KEY}`\n}\n\nconst ClassName = {\n  SHOW       : 'show',\n  COLLAPSE   : 'collapse',\n  COLLAPSING : 'collapsing',\n  COLLAPSED  : 'collapsed'\n}\n\nconst Dimension = {\n  WIDTH  : 'width',\n  HEIGHT : 'height'\n}\n\nconst Selector = {\n  ACTIVES     : '.show, .collapsing',\n  DATA_TOGGLE : '[data-toggle=\"collapse\"]'\n}\n\n/**\n * ------------------------------------------------------------------------\n * Class Definition\n * ------------------------------------------------------------------------\n */\n\nclass Collapse {\n  constructor(element, config) {\n    this._isTransitioning = false\n    this._element         = element\n    this._config          = this._getConfig(config)\n    this._triggerArray    = Util.makeArray(SelectorEngine.find(\n      `[data-toggle=\"collapse\"][href=\"#${element.id}\"],` +\n      `[data-toggle=\"collapse\"][data-target=\"#${element.id}\"]`\n    ))\n\n    const toggleList = Util.makeArray(SelectorEngine.find(Selector.DATA_TOGGLE))\n    for (let i = 0, len = toggleList.length; i < len; i++) {\n      const elem = toggleList[i]\n      const selector = Util.getSelectorFromElement(elem)\n      const filterElement = Util.makeArray(SelectorEngine.find(selector))\n        .filter((foundElem) => foundElem === element)\n\n      if (selector !== null && filterElement.length) {\n        this._selector = selector\n        this._triggerArray.push(elem)\n      }\n    }\n\n    this._parent = this._config.parent ? this._getParent() : null\n\n    if (!this._config.parent) {\n      this._addAriaAndCollapsedClass(this._element, this._triggerArray)\n    }\n\n    if (this._config.toggle) {\n      this.toggle()\n    }\n\n    Data.setData(element, DATA_KEY, this)\n  }\n\n  // Getters\n\n  static get VERSION() {\n    return VERSION\n  }\n\n  static get Default() {\n    return Default\n  }\n\n  // Public\n\n  toggle() {\n    if (this._element.classList.contains(ClassName.SHOW)) {\n      this.hide()\n    } else {\n      this.show()\n    }\n  }\n\n  show() {\n    if (this._isTransitioning ||\n      this._element.classList.contains(ClassName.SHOW)) {\n      return\n    }\n\n    let actives\n    let activesData\n\n    if (this._parent) {\n      actives = Util.makeArray(SelectorEngine.find(Selector.ACTIVES, this._parent))\n        .filter((elem) => {\n          if (typeof this._config.parent === 'string') {\n            return elem.getAttribute('data-parent') === this._config.parent\n          }\n\n          return elem.classList.contains(ClassName.COLLAPSE)\n        })\n\n      if (actives.length === 0) {\n        actives = null\n      }\n    }\n\n    const container = SelectorEngine.findOne(this._selector)\n    if (actives) {\n      const tempActiveData = actives.filter((elem) => container !== elem)\n      activesData = tempActiveData[0] ? Data.getData(tempActiveData[0], DATA_KEY) : null\n\n      if (activesData && activesData._isTransitioning) {\n        return\n      }\n    }\n\n    const startEvent = EventHandler.trigger(this._element, Event.SHOW)\n    if (startEvent.defaultPrevented) {\n      return\n    }\n\n    if (actives) {\n      actives.forEach((elemActive) => {\n        if (container !== elemActive) {\n          Collapse._collapseInterface(elemActive, 'hide')\n        }\n\n        if (!activesData) {\n          Data.setData(elemActive, DATA_KEY, null)\n        }\n      })\n    }\n\n    const dimension = this._getDimension()\n\n    this._element.classList.remove(ClassName.COLLAPSE)\n    this._element.classList.add(ClassName.COLLAPSING)\n\n    this._element.style[dimension] = 0\n\n    if (this._triggerArray.length) {\n      this._triggerArray.forEach((element) => {\n        element.classList.remove(ClassName.COLLAPSED)\n        element.setAttribute('aria-expanded', true)\n      })\n    }\n\n    this.setTransitioning(true)\n\n    const complete = () => {\n      this._element.classList.remove(ClassName.COLLAPSING)\n      this._element.classList.add(ClassName.COLLAPSE)\n      this._element.classList.add(ClassName.SHOW)\n\n      this._element.style[dimension] = ''\n\n      this.setTransitioning(false)\n\n      EventHandler.trigger(this._element, Event.SHOWN)\n    }\n\n    const capitalizedDimension = dimension[0].toUpperCase() + dimension.slice(1)\n    const scrollSize = `scroll${capitalizedDimension}`\n    const transitionDuration = Util.getTransitionDurationFromElement(this._element)\n\n    EventHandler.one(this._element, Util.TRANSITION_END, complete)\n\n    Util.emulateTransitionEnd(this._element, transitionDuration)\n    this._element.style[dimension] = `${this._element[scrollSize]}px`\n  }\n\n  hide() {\n    if (this._isTransitioning ||\n      !this._element.classList.contains(ClassName.SHOW)) {\n      return\n    }\n\n    const startEvent = EventHandler.trigger(this._element, Event.HIDE)\n    if (startEvent.defaultPrevented) {\n      return\n    }\n\n    const dimension = this._getDimension()\n\n    this._element.style[dimension] = `${this._element.getBoundingClientRect()[dimension]}px`\n\n    Util.reflow(this._element)\n\n    this._element.classList.add(ClassName.COLLAPSING)\n    this._element.classList.remove(ClassName.COLLAPSE)\n    this._element.classList.remove(ClassName.SHOW)\n\n    const triggerArrayLength = this._triggerArray.length\n    if (triggerArrayLength > 0) {\n      for (let i = 0; i < triggerArrayLength; i++) {\n        const trigger = this._triggerArray[i]\n        const selector = Util.getSelectorFromElement(trigger)\n\n        if (selector !== null) {\n          const elem = SelectorEngine.findOne(selector)\n\n          if (!elem.classList.contains(ClassName.SHOW)) {\n            trigger.classList.add(ClassName.COLLAPSED)\n            trigger.setAttribute('aria-expanded', false)\n          }\n        }\n      }\n    }\n\n    this.setTransitioning(true)\n\n    const complete = () => {\n      this.setTransitioning(false)\n      this._element.classList.remove(ClassName.COLLAPSING)\n      this._element.classList.add(ClassName.COLLAPSE)\n      EventHandler.trigger(this._element, Event.HIDDEN)\n    }\n\n    this._element.style[dimension] = ''\n    const transitionDuration = Util.getTransitionDurationFromElement(this._element)\n\n    EventHandler.one(this._element, Util.TRANSITION_END, complete)\n    Util.emulateTransitionEnd(this._element, transitionDuration)\n  }\n\n  setTransitioning(isTransitioning) {\n    this._isTransitioning = isTransitioning\n  }\n\n  dispose() {\n    Data.removeData(this._element, DATA_KEY)\n\n    this._config          = null\n    this._parent          = null\n    this._element         = null\n    this._triggerArray    = null\n    this._isTransitioning = null\n  }\n\n  // Private\n\n  _getConfig(config) {\n    config = {\n      ...Default,\n      ...config\n    }\n    config.toggle = Boolean(config.toggle) // Coerce string values\n    Util.typeCheckConfig(NAME, config, DefaultType)\n    return config\n  }\n\n  _getDimension() {\n    const hasWidth = this._element.classList.contains(Dimension.WIDTH)\n    return hasWidth ? Dimension.WIDTH : Dimension.HEIGHT\n  }\n\n  _getParent() {\n    let parent\n\n    if (Util.isElement(this._config.parent)) {\n      parent = this._config.parent\n\n      // it's a jQuery object\n      if (typeof this._config.parent.jquery !== 'undefined' || typeof this._config.parent[0] !== 'undefined') {\n        parent = this._config.parent[0]\n      }\n    } else {\n      parent = SelectorEngine.findOne(this._config.parent)\n    }\n\n    const selector =\n      `[data-toggle=\"collapse\"][data-parent=\"${this._config.parent}\"]`\n\n    Util.makeArray(SelectorEngine.find(selector, parent))\n      .forEach((element) => {\n        this._addAriaAndCollapsedClass(\n          Collapse._getTargetFromElement(element),\n          [element]\n        )\n      })\n\n    return parent\n  }\n\n  _addAriaAndCollapsedClass(element, triggerArray) {\n    if (element) {\n      const isOpen = element.classList.contains(ClassName.SHOW)\n\n      if (triggerArray.length) {\n        triggerArray.forEach((elem) => {\n          if (!isOpen) {\n            elem.classList.add(ClassName.COLLAPSED)\n          } else {\n            elem.classList.remove(ClassName.COLLAPSED)\n          }\n          elem.setAttribute('aria-expanded', isOpen)\n        })\n      }\n    }\n  }\n\n  // Static\n\n  static _getTargetFromElement(element) {\n    const selector = Util.getSelectorFromElement(element)\n    return selector ? SelectorEngine.findOne(selector) : null\n  }\n\n  static _collapseInterface(element, config) {\n    let data      = Data.getData(element, DATA_KEY)\n    const _config = {\n      ...Default,\n      ...Manipulator.getDataAttributes(element),\n      ...typeof config === 'object' && config ? config : {}\n    }\n\n    if (!data && _config.toggle && /show|hide/.test(config)) {\n      _config.toggle = false\n    }\n\n    if (!data) {\n      data = new Collapse(element, _config)\n    }\n\n    if (typeof config === 'string') {\n      if (typeof data[config] === 'undefined') {\n        throw new Error(`No method named \"${config}\"`)\n      }\n      data[config]()\n    }\n  }\n\n  static _jQueryInterface(config) {\n    return this.each(function () {\n      Collapse._collapseInterface(this, config)\n    })\n  }\n\n  static _getInstance(element) {\n    return Data.getData(element, DATA_KEY)\n  }\n}\n\n/**\n * ------------------------------------------------------------------------\n * Data Api implementation\n * ------------------------------------------------------------------------\n */\n\nEventHandler.on(document, Event.CLICK_DATA_API, Selector.DATA_TOGGLE, function (event) {\n  // preventDefault only for <a> elements (which change the URL) not inside the collapsible element\n  if (event.target.tagName === 'A') {\n    event.preventDefault()\n  }\n\n  const triggerData      = Manipulator.getDataAttributes(this)\n  const selector         = Util.getSelectorFromElement(this)\n  const selectorElements = Util.makeArray(SelectorEngine.find(selector))\n\n  selectorElements.forEach((element) => {\n    const data = Data.getData(element, DATA_KEY)\n    let config\n    if (data) {\n      // update parent attribute\n      if (data._parent === null && typeof triggerData.parent === 'string') {\n        data._config.parent = triggerData.parent\n        data._parent = data._getParent()\n      }\n      config = 'toggle'\n    } else {\n      config = triggerData\n    }\n\n    Collapse._collapseInterface(element, config)\n  })\n})\n\n/**\n * ------------------------------------------------------------------------\n * jQuery\n * ------------------------------------------------------------------------\n * add .collapse to jQuery only if jQuery is present\n */\n\nconst $ = Util.jQuery\nif (typeof $ !== 'undefined') {\n  const JQUERY_NO_CONFLICT  = $.fn[NAME]\n  $.fn[NAME]                = Collapse._jQueryInterface\n  $.fn[NAME].Constructor    = Collapse\n  $.fn[NAME].noConflict     = () => {\n    $.fn[NAME] = JQUERY_NO_CONFLICT\n    return Collapse._jQueryInterface\n  }\n}\n\nexport default Collapse\n"],"names":["NAME","VERSION","DATA_KEY","EVENT_KEY","DATA_API_KEY","Default","toggle","parent","DefaultType","Event","SHOW","SHOWN","HIDE","HIDDEN","CLICK_DATA_API","ClassName","COLLAPSE","COLLAPSING","COLLAPSED","Dimension","WIDTH","HEIGHT","Selector","ACTIVES","DATA_TOGGLE","Collapse","element","config","_isTransitioning","_element","_config","_getConfig","_triggerArray","Util","makeArray","SelectorEngine","find","id","toggleList","i","len","length","elem","selector","getSelectorFromElement","filterElement","filter","foundElem","_selector","push","_parent","_getParent","_addAriaAndCollapsedClass","Data","setData","classList","contains","hide","show","actives","activesData","getAttribute","container","findOne","tempActiveData","getData","startEvent","EventHandler","trigger","defaultPrevented","forEach","elemActive","_collapseInterface","dimension","_getDimension","remove","add","style","setAttribute","setTransitioning","complete","capitalizedDimension","toUpperCase","slice","scrollSize","transitionDuration","getTransitionDurationFromElement","one","TRANSITION_END","emulateTransitionEnd","getBoundingClientRect","reflow","triggerArrayLength","isTransitioning","dispose","removeData","Boolean","typeCheckConfig","hasWidth","isElement","jquery","_getTargetFromElement","triggerArray","isOpen","data","Manipulator","getDataAttributes","test","Error","_jQueryInterface","each","_getInstance","on","document","event","target","tagName","preventDefault","triggerData","selectorElements","$","jQuery","JQUERY_NO_CONFLICT","fn","Constructor","noConflict"],"mappings":"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"}